---
title: "Modified_graph_Mat"
output: html_document
date: "2024-02-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



We do not know yet how to identify countries.
However, we may analyse data for a specific country, for instance "number 3"

```{r fig.cap= ""}
# We start by creating a smaller base to work with
eulfs_pays3 <- eulfs_small %>% filter(countryw == 3) %>% select(hwactual, refyear)
# We indicate what statistics we want to appear on the plot
frame <- eulfs_pays3 %>% group_by(refyear, .drop = NA) %>% summarise(Min = min(hwactual, na.rm = TRUE), Max = max(hwactual, na.rm = TRUE), Median = median(hwactual, na.rm = TRUE), quant1 = quantile(hwactual, probs = 0.25, na.rm = TRUE), quant2 = quantile(hwactual, probs = 0.75, na.rm = TRUE))
# cat <- c(Min, quant1, Median, quant2, Max)
cols <- c("Min" = "black", "quant1" = "blue", "Median" = "darkred", "quant2" = "red", "Max" = "green")
# cols <- c("black", "blue", "darkred", "red", "green")
names <- c("Min", "quant1", "Median", "quant2", "Max")
p <- ggplot(frame, aes(x = refyear, na.rm = TRUE)) + geom_line(aes(y=Min), color = "Min") + geom_line(aes(y=Max), color = "Max") + geom_line(aes(y=Median), color = "Median") + geom_line(aes(y=quant1), color = "quant1") + geom_line(aes(y=quant2), color = "quant2") + labs(title = "Actual weekly working hours in 1st job in country 3", x=" ", y="Number of weekly working hours", color = "Legend") + scale_color_manual(values = cols)
# ggtitle("Actual weekly working hours in 1st job in country 3")
# Adding legends
# geom_line(aes(color=colnames(frame))) ; labels = names, 

p

```
We notice that all quartiles remain somewhat stable, except the first quartile.
Indeed, the quarter of the population who work the least has less and less working hours.
The number of hours dropped below 20 hours after 2010.

"""
scale_colour_manual("", breaks = c("Min", "quant1", "Median", "quant2", "Max"), values = c("black", "blue", "darkred", "red", "green"))

p <- ggplot(frame, aes(x = refyear, na.rm = TRUE)) + geom_line(aes(y=Min)) + geom_line(aes(y=Max), color = "green") + geom_line(aes(y=Median), color = "darkred") + geom_line(aes(y=quant1), color = "blue") + geom_line(aes(y=quant2), color = "red") + labs(title = "Actual weekly working hours in 1st job in country 3", x=" ", y="Number of weekly working hours", color = "Legend") + scale_color_manual(values = cols)

"""
